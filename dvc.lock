schema: '2.0'
stages:
  preprocess:
    cmd: python src/pretrain.py
    deps:
    - path: data/raw/YoutubeCommentsDataSet.csv
      hash: md5
      md5: 7f7869a48c0358a37bb032133dc7ce23
      size: 3488752
    - path: src/pretrain.py
      hash: md5
      md5: 851764546a82fdfec1748f5f0bc6b844
      size: 5701
    params:
      params.yaml:
        paths:
          raw_data: data/raw/YoutubeCommentsDataSet.csv
          processed_dir: data/processed/
          models_dir: models/
        preprocess:
          embedding_model: all-MiniLM-L6-v2
          test_size: 0.2
          random_state: 42
    outs:
    - path: data/processed/metadata.json
      hash: md5
      md5: 92045d92bb775c4471017c8bdc7d6674
      size: 278
    - path: data/processed/test_labels.npy
      hash: md5
      md5: 59c6c5b0a1e0083a6b7edbb9ade0ec96
      size: 29584
    - path: data/processed/test_vectors.npy
      hash: md5
      md5: 909bc8ac3b55890b750b5c1c07acc551
      size: 11429056
    - path: data/processed/train_labels.npy
      hash: md5
      md5: 81687550bab8261796a46e3a386ebab9
      size: 117944
    - path: data/processed/train_vectors.npy
      hash: md5
      md5: b26510a1a738f2232f7e55223918928d
      size: 45712736
  train_svm_baseline:
    cmd: python src/train_svm_noSMOTE.py
    deps:
    - path: data/processed/metadata.json
      hash: md5
      md5: 92045d92bb775c4471017c8bdc7d6674
      size: 278
    - path: data/processed/test_labels.npy
      hash: md5
      md5: 59c6c5b0a1e0083a6b7edbb9ade0ec96
      size: 29584
    - path: data/processed/test_vectors.npy
      hash: md5
      md5: 909bc8ac3b55890b750b5c1c07acc551
      size: 11429056
    - path: data/processed/train_labels.npy
      hash: md5
      md5: 81687550bab8261796a46e3a386ebab9
      size: 117944
    - path: data/processed/train_vectors.npy
      hash: md5
      md5: b26510a1a738f2232f7e55223918928d
      size: 45712736
    - path: src/train_svm_noSMOTE.py
      hash: md5
      md5: efbef06374c7947a127fa152e9143d25
      size: 6247
    params:
      params.yaml:
        mlflow:
          experiment_name: sentiment-classification
          tracking_uri: 
            https://dagshub.com/sairam030/mlops_sentimentAnalysis.mlflow
          registered_model_name: sentiment-best-model
        train.svm:
          kernel: rbf
          C: 1.0
          gamma: scale
          random_state: 42
    outs:
    - path: models/svm_baseline_info.json
      hash: md5
      md5: 826be3973f0046199e489719d029c3ea
      size: 565
    - path: models/svm_baseline_no_smote.joblib
      hash: md5
      md5: 7178079b49d8a7348306ca777c9cb6cd
      size: 24726115
    - path: models/svm_baseline_scaler.joblib
      hash: md5
      md5: 7120a2c77292bf57d984567197323c80
      size: 9895
  preprocess_smote:
    cmd: python src/pretrain.py --smote
    deps:
    - path: data/raw/YoutubeCommentsDataSet.csv
      hash: md5
      md5: 7f7869a48c0358a37bb032133dc7ce23
      size: 3488752
    - path: src/pretrain.py
      hash: md5
      md5: 851764546a82fdfec1748f5f0bc6b844
      size: 5701
    params:
      params.yaml:
        paths:
          raw_data: data/raw/YoutubeCommentsDataSet.csv
          processed_dir: data/processed/
          models_dir: models/
        preprocess:
          embedding_model: all-MiniLM-L6-v2
          test_size: 0.2
          random_state: 42
        train.smote:
          random_state: 42
    outs:
    - path: data/processed/smote/metadata.json
      hash: md5
      md5: f542ac558befd58e44571655a2150517
      size: 277
    - path: data/processed/smote/train_labels.npy
      hash: md5
      md5: 395cac478ba22bcadcd5a57e5e7dcedf
      size: 219632
    - path: data/processed/smote/train_vectors.npy
      hash: md5
      md5: c3ef495c8cbc5dd37c2e9f03a0355be5
      size: 85167680
  train_svm_smote:
    cmd: python src/train_svm.py
    deps:
    - path: data/processed/metadata.json
      hash: md5
      md5: 92045d92bb775c4471017c8bdc7d6674
      size: 278
    - path: data/processed/smote/train_labels.npy
      hash: md5
      md5: 395cac478ba22bcadcd5a57e5e7dcedf
      size: 219632
    - path: data/processed/smote/train_vectors.npy
      hash: md5
      md5: c3ef495c8cbc5dd37c2e9f03a0355be5
      size: 85167680
    - path: data/processed/test_labels.npy
      hash: md5
      md5: 59c6c5b0a1e0083a6b7edbb9ade0ec96
      size: 29584
    - path: data/processed/test_vectors.npy
      hash: md5
      md5: 909bc8ac3b55890b750b5c1c07acc551
      size: 11429056
    - path: src/train_svm.py
      hash: md5
      md5: 343ac9dbf7d5621b66a440486fb36708
      size: 6030
    params:
      params.yaml:
        mlflow:
          experiment_name: sentiment-classification
          tracking_uri: 
            https://dagshub.com/sairam030/mlops_sentimentAnalysis.mlflow
          registered_model_name: sentiment-best-model
        train.svm:
          kernel: rbf
          C: 1.0
          gamma: scale
          random_state: 42
    outs:
    - path: models/svm_model_info.json
      hash: md5
      md5: 30134b11fc66c829b4a662d9e3fbbb7c
      size: 547
    - path: models/svm_scaler.joblib
      hash: md5
      md5: af4af2a3e1483e6e331f466a0367d1a8
      size: 9895
    - path: models/svm_sentiment.joblib
      hash: md5
      md5: 12e4641697d19a8af1c3aac35c8380ba
      size: 38912643
  train_bert:
    cmd: python src/train_bert.py
    deps:
    - path: data/raw/YoutubeCommentsDataSet.csv
      hash: md5
      md5: 7f7869a48c0358a37bb032133dc7ce23
      size: 3488752
    - path: src/train_bert.py
      hash: md5
      md5: 8addf1536192f8b98e507d33213b6245
      size: 10459
    params:
      params.yaml:
        mlflow:
          experiment_name: sentiment-classification
          tracking_uri: 
            https://dagshub.com/sairam030/mlops_sentimentAnalysis.mlflow
          registered_model_name: sentiment-best-model
        train.bert:
          base_model: distilbert-base-uncased
          epochs: 3
          learning_rate: 2e-05
          batch_size: 16
          max_length: 128
          weight_decay: 0.01
          warmup_ratio: 0.1
    outs:
    - path: models/distilbert_info.json
      hash: md5
      md5: b9e4e488e88d2c89dfe9700d55f0acbd
      size: 457
    - path: models/distilbert_sentiment/
      hash: md5
      md5: 19928efb4f09c9ecfbb36f45339af4de.dir
      size: 268553655
      nfiles: 5
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: models/distilbert_info.json
      hash: md5
      md5: b9e4e488e88d2c89dfe9700d55f0acbd
      size: 457
    - path: models/svm_baseline_info.json
      hash: md5
      md5: 826be3973f0046199e489719d029c3ea
      size: 565
    - path: models/svm_model_info.json
      hash: md5
      md5: 30134b11fc66c829b4a662d9e3fbbb7c
      size: 547
    - path: src/evaluate.py
      hash: md5
      md5: 1db3dcb5c93a77d5404155eaf758733e
      size: 12706
    params:
      params.yaml:
        mlflow:
          experiment_name: sentiment-classification
          tracking_uri: 
            https://dagshub.com/sairam030/mlops_sentimentAnalysis.mlflow
          registered_model_name: sentiment-best-model
    outs:
    - path: models/model_comparison.csv
      hash: md5
      md5: 0aa2b81baefe338fc5383d27954d5cea
      size: 131
